{"version":3,"sources":["../static/js/8.115f39cd.chunk.js","routes/Login/model/index.js","routes/Login/service/index.js"],"names":["webpackJsonp","750","module","__webpack_exports__","__webpack_require__","Object","defineProperty","value","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator__","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default","n","__WEBPACK_IMPORTED_MODULE_1_dva_router__","__WEBPACK_IMPORTED_MODULE_2__service__","__WEBPACK_IMPORTED_MODULE_3_cmn_utils__","__WEBPACK_IMPORTED_MODULE_3_cmn_utils___default","namespace","state","loggedIn","message","user","menu","subscriptions","setup","_ref","history","dispatch","listen","_ref2","pathname","indexOf","a","removeStore","effects","login","mark","_ref3","_ref4","_ref5","status","data","payload","call","put","wrap","_context","prev","next","sent","setStore","type","stop","this","getMenu","_ref6","_ref7","_ref8","loopMenu","_context2","path","forEach","item","parentPath","children","length","replace","logout","_","_ref9","_context3","reducers","loginSuccess","_ref10","assign","loginError","_ref11","getMenuSuccess","_ref12","935","_asyncToGenerator","fn","gen","apply","arguments","Promise","resolve","reject","step","key","arg","info","error","done","then","err","d","__WEBPACK_IMPORTED_MODULE_1_cmn_utils__","__WEBPACK_IMPORTED_MODULE_1_cmn_utils___default","_callee","abrupt","post","_x","_callee2","_x2"],"mappings":"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","file":"static/js/8.115f39cd.chunk.js","sourcesContent":["webpackJsonp([8],{\n\n/***/ 750:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator__ = __webpack_require__(175);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_dva_router__ = __webpack_require__(38);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_dva_router___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_dva_router__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__service__ = __webpack_require__(935);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_cmn_utils__ = __webpack_require__(70);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_cmn_utils___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_cmn_utils__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({namespace:'login',state:{loggedIn:false,message:'',user:{},menu:[]},subscriptions:{setup:function setup(_ref){var history=_ref.history,dispatch=_ref.dispatch;return history.listen(function(_ref2){var pathname=_ref2.pathname;if(pathname.indexOf('/sign/login')!==-1){__WEBPACK_IMPORTED_MODULE_3_cmn_utils___default.a.removeStore('user');}});}},effects:{login:/*#__PURE__*/__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.mark(function login(_ref3,_ref4){var payload=_ref3.payload;var call=_ref4.call,put=_ref4.put;var _ref5,status,message,data;return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.wrap(function login$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return call(__WEBPACK_IMPORTED_MODULE_2__service__[\"b\" /* login */],payload);case 2:_ref5=_context.sent;status=_ref5.status;message=_ref5.message;data=_ref5.data;if(!status){_context.next=12;break;}__WEBPACK_IMPORTED_MODULE_3_cmn_utils___default.a.setStore('user',data);_context.next=10;return put({type:'getMenu',payload:payload});case 10:_context.next=14;break;case 12:_context.next=14;return put({type:'loginError',payload:{message:message}});case 14:case'end':return _context.stop();}}},login,this);}),getMenu:/*#__PURE__*/__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.mark(function getMenu(_ref6,_ref7){var payload=_ref6.payload;var call=_ref7.call,put=_ref7.put;var _ref8,status,data,loopMenu;return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.wrap(function getMenu$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return call(__WEBPACK_IMPORTED_MODULE_2__service__[\"a\" /* getMenu */],payload);case 2:_ref8=_context2.sent;status=_ref8.status;data=_ref8.data;if(!status){_context2.next=13;break;}loopMenu=function loopMenu(menu,path){menu.forEach(function(item){if(path){item.parentPath=path;}if(item.children&&item.children.length){loopMenu(item.children,item.path);}});};loopMenu(data);__WEBPACK_IMPORTED_MODULE_3_cmn_utils___default.a.setStore('menu',data);_context2.next=11;return put({type:'getMenuSuccess',payload:data});case 11:_context2.next=13;return put(__WEBPACK_IMPORTED_MODULE_1_dva_router__[\"routerRedux\"].replace('/'));case 13:case'end':return _context2.stop();}}},getMenu,this);}),logout:/*#__PURE__*/__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.mark(function logout(_,_ref9){var put=_ref9.put;return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.wrap(function logout$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:case'end':return _context3.stop();}}},logout,this);})},reducers:{loginSuccess:function loginSuccess(state,_ref10){var payload=_ref10.payload;return Object.assign({},state,{loggedIn:true,message:'',user:payload});},loginError:function loginError(state,_ref11){var payload=_ref11.payload;return Object.assign({},state,{loggedIn:false,message:payload.message});},getMenuSuccess:function getMenuSuccess(state,_ref12){var payload=_ref12.payload;return Object.assign({},state,{menu:payload});}}});\n\n/***/ }),\n\n/***/ 935:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return login; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return getMenu; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator__ = __webpack_require__(175);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_cmn_utils__ = __webpack_require__(70);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_cmn_utils___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_cmn_utils__);\nfunction _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg);var value=info.value;}catch(error){reject(error);return;}if(info.done){resolve(value);}else{return Promise.resolve(value).then(function(value){step(\"next\",value);},function(err){step(\"throw\",err);});}}return step(\"next\");});};}var login=function(){var _ref=_asyncToGenerator(/*#__PURE__*/__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.mark(function _callee(payload){return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:return _context.abrupt('return',__WEBPACK_IMPORTED_MODULE_1_cmn_utils___default.a.post('/user/login',payload));case 1:case'end':return _context.stop();}}},_callee,this);}));return function login(_x){return _ref.apply(this,arguments);};}();var getMenu=function(){var _ref2=_asyncToGenerator(/*#__PURE__*/__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.mark(function _callee2(payload){return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:return _context2.abrupt('return',__WEBPACK_IMPORTED_MODULE_1_cmn_utils___default.a.post('/user/menu',payload));case 1:case'end':return _context2.stop();}}},_callee2,this);}));return function getMenu(_x2){return _ref2.apply(this,arguments);};}();\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/8.115f39cd.chunk.js","import { routerRedux } from 'dva/router';\r\nimport { login, getMenu } from '../service';\r\nimport $$ from 'cmn-utils';\r\n\r\nexport default {\r\n  namespace: 'login',\r\n\r\n  state: {\r\n    loggedIn: false,\r\n    message: '',\r\n    user: {},\r\n    menu: [],\r\n  },\r\n\r\n  subscriptions: {\r\n    setup({ history, dispatch }) {\r\n      return history.listen(({ pathname }) => {\r\n        if (pathname.indexOf('/sign/login') !== -1) {\r\n          $$.removeStore('user');\r\n        }\r\n      });\r\n    }\r\n  },\r\n\r\n  effects: {\r\n    *login({ payload }, { call, put }) {\r\n      const { status, message, data } = yield call(login, payload);\r\n      if (status) {\r\n        $$.setStore('user', data);\r\n        yield put({\r\n          type: 'getMenu',\r\n          payload\r\n        });\r\n      } else {\r\n        yield put({\r\n          type: 'loginError',\r\n          payload: { message }\r\n        });\r\n      }\r\n    },\r\n    *getMenu({ payload }, { call, put }) {\r\n      const { status, data } = yield call(getMenu, payload);\r\n      if (status) {\r\n        const loopMenu = (menu, path) => {\r\n          menu.forEach(item => {\r\n            if (path) {\r\n              item.parentPath = path;\r\n            }\r\n            if (item.children && item.children.length) {\r\n              loopMenu(item.children, item.path);\r\n            }\r\n          });\r\n        }\r\n        loopMenu(data);\r\n        \r\n        $$.setStore('menu', data);\r\n        yield put({\r\n          type: 'getMenuSuccess',\r\n          payload: data,\r\n        });\r\n        yield put(routerRedux.replace('/'));\r\n      }\r\n    },\r\n    *logout(_, { put }) {}\r\n  },\r\n\r\n  reducers: {\r\n    loginSuccess(state, { payload }) {\r\n      return {\r\n        ...state,\r\n        loggedIn: true,\r\n        message: '',\r\n        user: payload\r\n      };\r\n    },\r\n    loginError(state, { payload }) {\r\n      return {\r\n        ...state,\r\n        loggedIn: false,\r\n        message: payload.message\r\n      };\r\n    },\r\n    getMenuSuccess(state, { payload }) {\r\n      return {\r\n        ...state,\r\n        menu: payload,\r\n      };\r\n    }\r\n  }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/routes/Login/model/index.js","import $$ from 'cmn-utils';\r\n\r\nexport async function login(payload) {\r\n  return $$.post('/user/login', payload);\r\n}\r\n\r\nexport async function getMenu(payload) {\r\n  return $$.post('/user/menu', payload);\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/routes/Login/service/index.js"],"sourceRoot":""}