{"version":3,"sources":["../static/js/13.9ad5e6b0.chunk.js","routes/Login/service/index.js","routes/Login/model/index.js"],"names":["webpackJsonp","1113","module","__webpack_exports__","__webpack_require__","_asyncToGenerator","fn","gen","apply","this","arguments","Promise","resolve","reject","step","key","arg","info","value","error","done","then","err","d","login","getMenu","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator__","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default","n","__WEBPACK_IMPORTED_MODULE_1_cmn_utils__","__WEBPACK_IMPORTED_MODULE_1_cmn_utils___default","_ref","a","mark","_callee","payload","wrap","_context","prev","next","abrupt","post","stop","_x","_ref2","_callee2","_context2","_x2","777","Object","defineProperty","__WEBPACK_IMPORTED_MODULE_1_dva_router__","__WEBPACK_IMPORTED_MODULE_2__service__","__WEBPACK_IMPORTED_MODULE_3_cmn_utils__","__WEBPACK_IMPORTED_MODULE_3_cmn_utils___default","namespace","state","loggedIn","message","user","menu","subscriptions","setup","history","dispatch","listen","pathname","indexOf","removeStore","effects","_ref3","_ref4","_ref5","status","data","call","put","sent","setStore","type","_ref6","_ref7","_ref8","loopMenu","path","forEach","item","parentPath","children","length","replace","logout","_","_ref9","_context3","reducers","loginSuccess","_ref10","assign","loginError","_ref11","getMenuSuccess","_ref12"],"mappings":"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","file":"static/js/13.9ad5e6b0.chunk.js","sourcesContent":["webpackJsonp([13],{\n\n/***/ 1113:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return login; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return getMenu; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator__ = __webpack_require__(180);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_cmn_utils__ = __webpack_require__(71);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_cmn_utils___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_cmn_utils__);\nfunction _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg);var value=info.value;}catch(error){reject(error);return;}if(info.done){resolve(value);}else{return Promise.resolve(value).then(function(value){step(\"next\",value);},function(err){step(\"throw\",err);});}}return step(\"next\");});};}var login=function(){var _ref=_asyncToGenerator(/*#__PURE__*/__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.mark(function _callee(payload){return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:return _context.abrupt('return',__WEBPACK_IMPORTED_MODULE_1_cmn_utils___default.a.post('/user/login',payload));case 1:case'end':return _context.stop();}}},_callee,this);}));return function login(_x){return _ref.apply(this,arguments);};}();var getMenu=function(){var _ref2=_asyncToGenerator(/*#__PURE__*/__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.mark(function _callee2(payload){return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:return _context2.abrupt('return',__WEBPACK_IMPORTED_MODULE_1_cmn_utils___default.a.post('/user/menu',payload));case 1:case'end':return _context2.stop();}}},_callee2,this);}));return function getMenu(_x2){return _ref2.apply(this,arguments);};}();\n\n/***/ }),\n\n/***/ 777:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator__ = __webpack_require__(180);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_dva_router__ = __webpack_require__(39);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_dva_router___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_dva_router__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__service__ = __webpack_require__(1113);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_cmn_utils__ = __webpack_require__(71);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_cmn_utils___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_cmn_utils__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({namespace:'login',state:{loggedIn:false,message:'',user:{},menu:[]},subscriptions:{setup:function setup(_ref){var history=_ref.history,dispatch=_ref.dispatch;return history.listen(function(_ref2){var pathname=_ref2.pathname;if(pathname.indexOf('/sign/login')!==-1){__WEBPACK_IMPORTED_MODULE_3_cmn_utils___default.a.removeStore('user');}});}},effects:{login:/*#__PURE__*/__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.mark(function login(_ref3,_ref4){var payload=_ref3.payload;var call=_ref4.call,put=_ref4.put;var _ref5,status,message,data;return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.wrap(function login$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return call(__WEBPACK_IMPORTED_MODULE_2__service__[\"b\" /* login */],payload);case 2:_ref5=_context.sent;status=_ref5.status;message=_ref5.message;data=_ref5.data;if(!status){_context.next=12;break;}__WEBPACK_IMPORTED_MODULE_3_cmn_utils___default.a.setStore('user',data);_context.next=10;return put({type:'getMenu',payload:payload});case 10:_context.next=14;break;case 12:_context.next=14;return put({type:'loginError',payload:{message:message}});case 14:case'end':return _context.stop();}}},login,this);}),getMenu:/*#__PURE__*/__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.mark(function getMenu(_ref6,_ref7){var payload=_ref6.payload;var call=_ref7.call,put=_ref7.put;var _ref8,status,data,loopMenu;return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.wrap(function getMenu$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return call(__WEBPACK_IMPORTED_MODULE_2__service__[\"a\" /* getMenu */],payload);case 2:_ref8=_context2.sent;status=_ref8.status;data=_ref8.data;if(!status){_context2.next=13;break;}loopMenu=function loopMenu(menu,path){menu.forEach(function(item){if(path){item.parentPath=path;}if(item.children&&item.children.length){loopMenu(item.children,item.path);}});};loopMenu(data);__WEBPACK_IMPORTED_MODULE_3_cmn_utils___default.a.setStore('menu',data);_context2.next=11;return put({type:'getMenuSuccess',payload:data});case 11:_context2.next=13;return put(__WEBPACK_IMPORTED_MODULE_1_dva_router__[\"routerRedux\"].replace('/'));case 13:case'end':return _context2.stop();}}},getMenu,this);}),logout:/*#__PURE__*/__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.mark(function logout(_,_ref9){var put=_ref9.put;return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.wrap(function logout$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:case'end':return _context3.stop();}}},logout,this);})},reducers:{loginSuccess:function loginSuccess(state,_ref10){var payload=_ref10.payload;return Object.assign({},state,{loggedIn:true,message:'',user:payload});},loginError:function loginError(state,_ref11){var payload=_ref11.payload;return Object.assign({},state,{loggedIn:false,message:payload.message});},getMenuSuccess:function getMenuSuccess(state,_ref12){var payload=_ref12.payload;return Object.assign({},state,{menu:payload});}}});\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/13.9ad5e6b0.chunk.js","import $$ from 'cmn-utils';\r\n\r\nexport async function login(payload) {\r\n  return $$.post('/user/login', payload);\r\n}\r\n\r\nexport async function getMenu(payload) {\r\n  return $$.post('/user/menu', payload);\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/routes/Login/service/index.js","import { routerRedux } from 'dva/router';\r\nimport { login, getMenu } from '../service';\r\nimport $$ from 'cmn-utils';\r\n\r\nexport default {\r\n  namespace: 'login',\r\n\r\n  state: {\r\n    loggedIn: false,\r\n    message: '',\r\n    user: {},\r\n    menu: [],\r\n  },\r\n\r\n  subscriptions: {\r\n    setup({ history, dispatch }) {\r\n      return history.listen(({ pathname }) => {\r\n        if (pathname.indexOf('/sign/login') !== -1) {\r\n          $$.removeStore('user');\r\n        }\r\n      });\r\n    }\r\n  },\r\n\r\n  effects: {\r\n    *login({ payload }, { call, put }) {\r\n      const { status, message, data } = yield call(login, payload);\r\n      if (status) {\r\n        $$.setStore('user', data);\r\n        yield put({\r\n          type: 'getMenu',\r\n          payload\r\n        });\r\n      } else {\r\n        yield put({\r\n          type: 'loginError',\r\n          payload: { message }\r\n        });\r\n      }\r\n    },\r\n    *getMenu({ payload }, { call, put }) {\r\n      const { status, data } = yield call(getMenu, payload);\r\n      if (status) {\r\n        const loopMenu = (menu, path) => {\r\n          menu.forEach(item => {\r\n            if (path) {\r\n              item.parentPath = path;\r\n            }\r\n            if (item.children && item.children.length) {\r\n              loopMenu(item.children, item.path);\r\n            }\r\n          });\r\n        }\r\n        loopMenu(data);\r\n        \r\n        $$.setStore('menu', data);\r\n        yield put({\r\n          type: 'getMenuSuccess',\r\n          payload: data,\r\n        });\r\n        yield put(routerRedux.replace('/'));\r\n      }\r\n    },\r\n    *logout(_, { put }) {}\r\n  },\r\n\r\n  reducers: {\r\n    loginSuccess(state, { payload }) {\r\n      return {\r\n        ...state,\r\n        loggedIn: true,\r\n        message: '',\r\n        user: payload\r\n      };\r\n    },\r\n    loginError(state, { payload }) {\r\n      return {\r\n        ...state,\r\n        loggedIn: false,\r\n        message: payload.message\r\n      };\r\n    },\r\n    getMenuSuccess(state, { payload }) {\r\n      return {\r\n        ...state,\r\n        menu: payload,\r\n      };\r\n    }\r\n  }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/routes/Login/model/index.js"],"sourceRoot":""}